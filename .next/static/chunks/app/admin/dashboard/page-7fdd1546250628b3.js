(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[427],{3060:function(e,s,a){Promise.resolve().then(a.bind(a,5860))},5860:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return er}});var r=a(7437),t=a(2265),l=a(5526),i=a(9820),n=a(2381),d=a(279),c=a(5060),o=a(9027),m=a(2489),x=a(3448);let u=o.fC,h=o.xz,g=o.h_;o.x8;let p=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(o.aV,{ref:s,className:(0,x.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t})});p.displayName=o.aV.displayName;let f=t.forwardRef((e,s)=>{let{className:a,children:t,...l}=e;return(0,r.jsxs)(g,{children:[(0,r.jsx)(p,{}),(0,r.jsxs)(o.VY,{ref:s,className:(0,x.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white text-gray-900 p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[t,(0,r.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=o.VY.displayName;let j=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,x.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...a})};j.displayName="DialogHeader";let b=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(o.Dx,{ref:s,className:(0,x.cn)("text-lg font-semibold leading-none tracking-tight text-gray-900",a),...t})});b.displayName=o.Dx.displayName,t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(o.dk,{ref:s,className:(0,x.cn)("text-sm text-muted-foreground",a),...t})}).displayName=o.dk.displayName;var N=a(1312);let y=N.fC,v=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(N.aV,{ref:s,className:(0,x.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...t})});v.displayName=N.aV.displayName;let w=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(N.xz,{ref:s,className:(0,x.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...t})});w.displayName=N.xz.displayName;let C=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(N.VY,{ref:s,className:(0,x.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...t})});C.displayName=N.VY.displayName;var Z=a(9174),_=a(3675),S=a(5291),E=a(5863),z=a(7689),k=a(9694);let R="properties-images";async function I(e){try{if(!e.type.startsWith("image/"))return{success:!1,error:"El archivo debe ser una imagen"};if(e.size>5242880)return{success:!1,error:"La imagen es demasiado grande (m\xe1ximo 5MB)"};let s=e.name.split(".").pop(),a="".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2),".").concat(s),{data:r,error:t}=await l.O.storage.from(R).upload(a,e);if(t)return{success:!1,error:t.message};let{data:i}=l.O.storage.from(R).getPublicUrl(a);return{success:!0,url:i.publicUrl}}catch(e){return{success:!1,error:"Error al subir la imagen"}}}function A(e){let{value:s,onChange:a}=e,[l,i]=(0,t.useState)(!1),[d,c]=(0,t.useState)(""),o=(0,t.useRef)(null),x=s?s.split(",").map(e=>e.trim()).filter(e=>e):[],u=async e=>{let s=Array.from(e.target.files||[]);if(0!==s.length){i(!0),c("");try{let e=s.map(e=>I(e)),r=await Promise.all(e),t=[],l=[];if(r.forEach((e,a)=>{e.success&&e.url?t.push(e.url):l.push("".concat(s[a].name,": ").concat(e.error))}),t.length>0){let e=[...x,...t];a(e.join(", "))}l.length>0&&c(l.join(", "))}catch(e){c("Error al subir las im\xe1genes")}finally{i(!1),o.current&&(o.current.value="")}}},h=e=>{a(x.filter((s,a)=>a!==e).join(", "))};return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(n.z,{type:"button",variant:"outline",onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.click()},disabled:l,className:"bg-white hover:bg-gray-50",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Subiendo..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z.Z,{className:"h-4 w-4 mr-2"}),"Subir Im\xe1genes"]})}),(0,r.jsx)("input",{ref:o,type:"file",multiple:!0,accept:"image/*",onChange:u,className:"hidden"})]}),d&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-2",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:d})}),x.length>0&&(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:x.map((e,s)=>(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:(0,r.jsx)("img",{src:e,alt:"Imagen ".concat(s+1),className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="",e.currentTarget.style.display="none"}})}),(0,r.jsx)(n.z,{type:"button",size:"sm",variant:"destructive",className:"absolute -top-2 -right-2 h-6 w-6 p-0 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>h(s),children:(0,r.jsx)(m.Z,{className:"h-3 w-3"})})]},s))}),0===x.length&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"No hay im\xe1genes seleccionadas"})]})}function F(e){let{formData:s,onInputChange:a,onSubmit:t,isLoading:l,isEditing:i,onCancel:o}=e;return(0,r.jsxs)("form",{onSubmit:t,className:"space-y-6 bg-white text-gray-900",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"title",className:"text-gray-700 font-medium",children:"T\xedtulo *"}),(0,r.jsx)(d.I,{id:"title",value:s.title,onChange:e=>a("title",e.target.value),placeholder:"Ej: Casa moderna en el centro",required:!0,className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"price",className:"text-gray-700 font-medium",children:"Precio *"}),(0,r.jsx)(d.I,{id:"price",type:"number",step:"0.01",min:"0",value:s.price,onChange:e=>a("price",e.target.value),placeholder:"250000",required:!0,className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-primary-400 focus:ring-primary-400"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"currency",className:"text-gray-700 font-medium",children:"Moneda"}),(0,r.jsxs)(S.Ph,{value:s.currency,onValueChange:e=>a("currency",e),children:[(0,r.jsx)(S.i4,{className:"mt-1 bg-white border-gray-300 focus:border-blue-500",children:(0,r.jsx)(S.ki,{})}),(0,r.jsxs)(S.Bw,{className:"bg-white border border-gray-200",children:[(0,r.jsx)(S.Ql,{value:"USD",children:"USD"}),(0,r.jsx)(S.Ql,{value:"ARS",children:"ARS"}),(0,r.jsx)(S.Ql,{value:"EUR",children:"EUR"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"operation_type",className:"text-gray-700 font-medium",children:"Operaci\xf3n *"}),(0,r.jsxs)(S.Ph,{value:s.operation_type,onValueChange:e=>a("operation_type",e),children:[(0,r.jsx)(S.i4,{className:"mt-1 bg-white border-gray-300 focus:border-blue-500",children:(0,r.jsx)(S.ki,{placeholder:"Seleccionar"})}),(0,r.jsxs)(S.Bw,{className:"bg-white border border-gray-200",children:[(0,r.jsx)(S.Ql,{value:"venta",children:"Venta"}),(0,r.jsx)(S.Ql,{value:"alquiler",children:"Alquiler"})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"property_type",className:"text-gray-700 font-medium",children:"Tipo de Propiedad *"}),(0,r.jsxs)(S.Ph,{value:s.property_type,onValueChange:e=>a("property_type",e),children:[(0,r.jsx)(S.i4,{className:"mt-1 bg-white border-gray-300 focus:border-blue-500",children:(0,r.jsx)(S.ki,{placeholder:"Seleccionar"})}),(0,r.jsxs)(S.Bw,{className:"bg-white border border-gray-200",children:[(0,r.jsx)(S.Ql,{value:"casa",children:"Casa"}),(0,r.jsx)(S.Ql,{value:"apartamento",children:"Apartamento"}),(0,r.jsx)(S.Ql,{value:"oficina",children:"Oficina"}),(0,r.jsx)(S.Ql,{value:"local",children:"Local"}),(0,r.jsx)(S.Ql,{value:"terreno",children:"Terreno"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"bedrooms",className:"text-gray-700 font-medium",children:"Dormitorios"}),(0,r.jsx)(d.I,{id:"bedrooms",type:"number",min:"0",max:"20",value:s.bedrooms,onChange:e=>a("bedrooms",e.target.value),className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-primary-400 focus:ring-primary-400"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"bathrooms",className:"text-gray-700 font-medium",children:"Ba\xf1os"}),(0,r.jsx)(d.I,{id:"bathrooms",type:"number",min:"0",max:"20",value:s.bathrooms,onChange:e=>a("bathrooms",e.target.value),className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-primary-400 focus:ring-primary-400"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"area_m2",className:"text-gray-700 font-medium",children:"\xc1rea (m\xb2)"}),(0,r.jsx)(d.I,{id:"area_m2",type:"number",step:"0.01",min:"0",value:s.area_m2,onChange:e=>a("area_m2",e.target.value),placeholder:"150.5",className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-primary-400 focus:ring-primary-400"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"lot_area_m2",className:"text-gray-700 font-medium",children:"\xc1rea del Lote (m\xb2)"}),(0,r.jsx)(d.I,{id:"lot_area_m2",type:"number",step:"0.01",min:"0",value:s.lot_area_m2,onChange:e=>a("lot_area_m2",e.target.value),placeholder:"200.0",className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-primary-400 focus:ring-primary-400"})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"address",className:"text-gray-700 font-medium",children:"Direcci\xf3n"}),(0,r.jsx)(d.I,{id:"address",value:s.address,onChange:e=>a("address",e.target.value),placeholder:"Calle San Mart\xedn 123",className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"neighborhood",className:"text-gray-700 font-medium",children:"Barrio"}),(0,r.jsx)(d.I,{id:"neighborhood",value:s.neighborhood,onChange:e=>a("neighborhood",e.target.value),placeholder:"Centro",className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"city",className:"text-gray-700 font-medium",children:"Ciudad"}),(0,r.jsx)(d.I,{id:"city",value:s.city,onChange:e=>a("city",e.target.value),className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"province",className:"text-gray-700 font-medium",children:"Provincia"}),(0,r.jsx)(d.I,{id:"province",value:s.province,onChange:e=>a("province",e.target.value),className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"features",className:"text-gray-700 font-medium",children:"Caracter\xedsticas (separadas por comas)"}),(0,r.jsx)(d.I,{id:"features",value:s.features,onChange:e=>a("features",e.target.value),placeholder:"garage, jard\xedn, piscina, aire acondicionado",className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Ejemplos: garage, jard\xedn, piscina, aire acondicionado, cocina equipada, seguridad 24h"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{className:"text-gray-700 font-medium",children:"Im\xe1genes de la Propiedad"}),(0,r.jsx)(A,{value:s.images,onChange:e=>a("images",e)})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"status",className:"text-gray-700 font-medium",children:"Estado"}),(0,r.jsxs)(S.Ph,{value:s.status,onValueChange:e=>a("status",e),children:[(0,r.jsx)(S.i4,{className:"mt-1 bg-white border-gray-300 focus:border-blue-500",children:(0,r.jsx)(S.ki,{})}),(0,r.jsxs)(S.Bw,{className:"bg-white border border-gray-200",children:[(0,r.jsx)(S.Ql,{value:"disponible",children:"Disponible"}),(0,r.jsx)(S.Ql,{value:"vendido",children:"Vendido"}),(0,r.jsx)(S.Ql,{value:"alquilado",children:"Alquilado"}),(0,r.jsx)(S.Ql,{value:"reservado",children:"Reservado"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 pt-8",children:[(0,r.jsx)("input",{type:"checkbox",id:"featured",checked:s.featured,onChange:e=>a("featured",e.target.checked),className:"h-4 w-4 rounded border-gray-300 bg-white focus:border-primary-400 focus:ring-primary-400"}),(0,r.jsx)(c._,{htmlFor:"featured",className:"text-sm font-medium text-gray-700 leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Propiedad Destacada"})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{htmlFor:"description",className:"text-gray-700 font-medium",children:"Descripci\xf3n"}),(0,r.jsx)(_.g,{id:"description",value:s.description,onChange:e=>a("description",e.target.value),placeholder:"Descripci\xf3n detallada de la propiedad. Incluye detalles sobre las comodidades, ubicaci\xf3n, estado de la propiedad, etc.",rows:4,className:"mt-1 bg-white border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500 resize-none"})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[(0,r.jsx)(n.z,{type:"button",variant:"outline",onClick:o,disabled:l,className:"bg-white hover:bg-gray-50 text-gray-700 border-gray-300",children:"Cancelar"}),(0,r.jsx)(n.z,{type:"submit",disabled:l,className:"min-w-[140px] bg-primary-400 hover:bg-primary-500 text-white",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z,{className:"mr-2 h-4 w-4 animate-spin"}),i?"Actualizando...":"Creando..."]}):i?"Actualizar Propiedad":"Crear Propiedad"})]})]})}let D=(0,a(535).j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),O=t.forwardRef((e,s)=>{let{className:a,variant:t,...l}=e;return(0,r.jsx)("div",{ref:s,role:"alert",className:(0,x.cn)(D({variant:t}),a),...l})});O.displayName="Alert",t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("h5",{ref:s,className:(0,x.cn)("mb-1 font-medium leading-none tracking-tight",a),...t})}).displayName="AlertTitle";let P=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,x.cn)("text-sm [&_p]:leading-relaxed",a),...t})});P.displayName="AlertDescription";var Y=a(5302),q=a(3639),V=a(6221),T=a(2208),Q=a(8930);function B(){let[e,s]=(0,t.useState)(!1),[a,l]=(0,t.useState)(null),[d,c]=(0,t.useState)(null),[o,m]=(0,t.useState)(null),x=(e,s)=>{m({type:e,text:s}),setTimeout(()=>m(null),5e3)},u=async()=>{s(!0);try{let e=await (0,k.In)();e.success&&e.stats?(l(e.stats),x("success","Estad\xedsticas cargadas correctamente")):x("error",e.error||"Error al cargar estad\xedsticas")}catch(e){x("error","Error inesperado al cargar estad\xedsticas")}finally{s(!1)}},h=async()=>{s(!0);try{let e=await (0,k.y9)();e.success&&e.data?(c(e.data),x("success","An\xe1lisis completado: ".concat(e.data.orphanedFiles.length," im\xe1genes hu\xe9rfanas encontradas"))):x("error",e.error||"Error al analizar im\xe1genes hu\xe9rfanas")}catch(e){x("error","Error inesperado durante el an\xe1lisis")}finally{s(!1)}},g=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];s(!0);try{let s=await (0,k.iQ)(e);s.success?(x("success","".concat(e?"Simulaci\xf3n":"Limpieza"," completada: ").concat(s.deletedCount," archivos se ").concat(e?"simular\xedan":"eliminaron")),e||(await u(),c(null))):x("error",s.error||"Error durante la limpieza")}catch(e){x("error","Error inesperado durante la limpieza")}finally{s(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Gesti\xf3n de Storage"}),(0,r.jsxs)(n.z,{onClick:u,disabled:e,variant:"outline",children:[e?(0,r.jsx)(E.Z,{className:"w-4 h-4 animate-spin mr-2"}):(0,r.jsx)(V.Z,{className:"w-4 h-4 mr-2"}),"Actualizar Estad\xedsticas"]})]}),o&&(0,r.jsx)(O,{className:"error"===o.type?"border-red-500":"warning"===o.type?"border-yellow-500":"border-green-500",children:(0,r.jsx)(P,{children:o.text})}),a&&(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsxs)(i.ll,{className:"flex items-center justify-between",children:["Estad\xedsticas del Storage",(e=>{switch(e){case"excelente":return(0,r.jsxs)(Z.C,{variant:"default",className:"bg-green-500",children:[(0,r.jsx)(Y.Z,{className:"w-3 h-3 mr-1"}),"Excelente"]});case"bueno":return(0,r.jsx)(Z.C,{variant:"secondary",className:"bg-blue-500 text-white",children:"Bueno"});case"regular":return(0,r.jsx)(Z.C,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:"Regular"});case"requiere_atencion":return(0,r.jsxs)(Z.C,{variant:"destructive",children:[(0,r.jsx)(q.Z,{className:"w-3 h-3 mr-1"}),"Requiere Atenci\xf3n"]});default:return(0,r.jsx)(Z.C,{variant:"outline",children:"Desconocido"})}})(a.storageHealth)]}),(0,r.jsxs)(i.SZ,{children:["\xdaltima actualizaci\xf3n: ",new Date(a.lastCheck).toLocaleString()]})]}),(0,r.jsx)(i.aY,{children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:a.totalFiles}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Total de archivos"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:a.referencedImages}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Im\xe1genes referenciadas"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-600",children:a.orphanedImages}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Im\xe1genes hu\xe9rfanas"})]})]})})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[(0,r.jsx)(i.ll,{children:"An\xe1lisis de Im\xe1genes Hu\xe9rfanas"}),(0,r.jsx)(i.SZ,{children:"Encuentra y gestiona archivos que no est\xe1n siendo referenciados por ninguna propiedad"})]}),(0,r.jsxs)(i.aY,{className:"space-y-4",children:[(0,r.jsxs)(n.z,{onClick:h,disabled:e,children:[e?(0,r.jsx)(E.Z,{className:"w-4 h-4 animate-spin mr-2"}):(0,r.jsx)(T.Z,{className:"w-4 h-4 mr-2"}),"Analizar Im\xe1genes Hu\xe9rfanas"]}),d&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Archivos en Storage:"})," ",d.totalFilesInStorage]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:"Archivos hu\xe9rfanos:"})," ",d.orphanedFiles.length]})]}),d.orphanedFiles.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(O,{children:[(0,r.jsx)(q.Z,{className:"h-4 w-4"}),(0,r.jsxs)(P,{children:["Se encontraron ",d.orphanedFiles.length," archivos hu\xe9rfanos que pueden ser eliminados."]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h4",{className:"font-semibold",children:"Archivos hu\xe9rfanos encontrados:"}),(0,r.jsx)("div",{className:"max-h-40 overflow-y-auto bg-gray-50 p-3 rounded border text-sm",children:d.orphanedFiles.map((e,s)=>(0,r.jsxs)("div",{className:"py-1",children:[s+1,". ",e]},s))})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(n.z,{onClick:()=>g(!0),disabled:e,variant:"outline",children:[e?(0,r.jsx)(E.Z,{className:"w-4 h-4 animate-spin mr-2"}):(0,r.jsx)(T.Z,{className:"w-4 h-4 mr-2"}),"Simular Limpieza"]}),(0,r.jsxs)(n.z,{onClick:()=>g(!1),disabled:e,variant:"destructive",children:[e?(0,r.jsx)(E.Z,{className:"w-4 h-4 animate-spin mr-2"}):(0,r.jsx)(Q.Z,{className:"w-4 h-4 mr-2"}),"Eliminar Archivos Hu\xe9rfanos"]})]})]}),0===d.orphanedFiles.length&&(0,r.jsxs)(O,{children:[(0,r.jsx)(Y.Z,{className:"h-4 w-4"}),(0,r.jsx)(P,{children:"\xa1Excelente! No se encontraron im\xe1genes hu\xe9rfanas. El Storage est\xe1 limpio."})]})]})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsx)(i.Ol,{children:(0,r.jsx)(i.ll,{children:"Mejores Pr\xe1cticas"})}),(0,r.jsx)(i.aY,{children:(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:["• ",(0,r.jsx)("strong",{children:"An\xe1lisis regular:"})," Ejecuta el an\xe1lisis de im\xe1genes hu\xe9rfanas semanalmente"]}),(0,r.jsxs)("p",{children:["• ",(0,r.jsx)("strong",{children:"Simula antes de limpiar:"})," Siempre usa la simulaci\xf3n antes de eliminar archivos"]}),(0,r.jsxs)("p",{children:["• ",(0,r.jsx)("strong",{children:"Backup:"})," Considera hacer respaldo antes de eliminar grandes cantidades de archivos"]}),(0,r.jsxs)("p",{children:["• ",(0,r.jsx)("strong",{children:"Monitoreo:"}),' Mant\xe9n el estado del Storage en "Excelente" o "Bueno"']}),(0,r.jsxs)("p",{children:["• ",(0,r.jsx)("strong",{children:"Eliminaci\xf3n segura:"})," Usa la funci\xf3n de eliminaci\xf3n segura para propiedades futuras"]})]})})]})]})}var L=a(4428),U=a(7168);function H(e){let{onViewDetails:s}=e,[a,l]=(0,t.useState)(null),[d,c]=(0,t.useState)(!0),[o,m]=(0,t.useState)(null),x=async()=>{try{c(!0),m(null);let e=await (0,k.In)();e.success&&e.stats?l(e.stats):m(e.error||"Error al cargar estad\xedsticas")}catch(e){m("Error inesperado")}finally{c(!1)}};return(0,t.useEffect)(()=>{x()},[]),(0,r.jsxs)(i.Zb,{className:"bg-white border border-gray-200 shadow-sm",children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsxs)(i.ll,{className:"text-sm font-medium flex items-center gap-2",children:[(0,r.jsx)(L.Z,{className:"h-4 w-4"}),"Estado del Storage"]}),(0,r.jsx)(n.z,{variant:"ghost",size:"sm",onClick:x,disabled:d,className:"h-8 w-8 p-0",children:d?(0,r.jsx)(E.Z,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(U.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)(i.aY,{children:d?(0,r.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,r.jsx)(E.Z,{className:"h-6 w-6 animate-spin text-gray-400"})}):o?(0,r.jsxs)("div",{className:"text-center py-4",children:[(0,r.jsx)("p",{className:"text-sm text-red-600 mb-2",children:o}),(0,r.jsx)(n.z,{variant:"outline",size:"sm",onClick:x,children:"Reintentar"})]}):a?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Estado:"}),(e=>{switch(e){case"excelente":return(0,r.jsxs)(Z.C,{variant:"default",className:"bg-green-500 text-white",children:[(0,r.jsx)(Y.Z,{className:"w-3 h-3 mr-1"}),"Excelente"]});case"bueno":return(0,r.jsx)(Z.C,{variant:"secondary",className:"bg-blue-500 text-white",children:"Bueno"});case"regular":return(0,r.jsx)(Z.C,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:"Regular"});case"requiere_atencion":return(0,r.jsxs)(Z.C,{variant:"destructive",children:[(0,r.jsx)(q.Z,{className:"w-3 h-3 mr-1"}),"Requiere Atenci\xf3n"]});default:return(0,r.jsx)(Z.C,{variant:"outline",children:"Desconocido"})}})(a.storageHealth)]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Total:"}),(0,r.jsx)("span",{className:"font-medium ml-1",children:a.totalFiles})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:"Hu\xe9rfanas:"}),(0,r.jsx)("span",{className:"font-medium ml-1 ".concat((e=>{switch(e){case"excelente":return"text-green-600";case"bueno":return"text-blue-600";case"regular":return"text-yellow-600";case"requiere_atencion":return"text-red-600";default:return"text-gray-600"}})(a.storageHealth)),children:a.orphanedImages})]})]}),a.orphanedImages>0&&(0,r.jsxs)("div",{className:"pt-2 border-t border-gray-100",children:[(0,r.jsxs)("p",{className:"text-xs text-gray-500 mb-2",children:["Se encontraron ",a.orphanedImages," im\xe1genes hu\xe9rfanas"]}),(0,r.jsx)(n.z,{variant:"outline",size:"sm",onClick:s,className:"w-full text-xs h-7",children:"Gestionar Storage"})]}),0===a.orphanedImages&&(0,r.jsx)("div",{className:"pt-2 border-t border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-green-600",children:[(0,r.jsx)(Y.Z,{className:"w-3 h-3"}),"Storage optimizado"]})})]}):null})]})}var G=a(9376),M=a(8906),W=a(5832),$=a(5252),J=a(44),K=a(9397),X=a(3113),ee=a(5868),es=a(3774),ea=a(8785);function er(){let e=(0,G.useRouter)(),[s,a]=(0,t.useState)(null),[o,m]=(0,t.useState)(null),[x,g]=(0,t.useState)(!0),[p,N]=(0,t.useState)(""),[_,S]=(0,t.useState)(!1),[z,k]=(0,t.useState)(ea.CH),[R,I]=(0,t.useState)(null),[A,D]=(0,t.useState)("overview"),[O,P]=(0,t.useState)(!1),[Y,V]=(0,t.useState)(!1),{properties:U,isLoading:er,error:et,stats:el,createProperty:ei,updateProperty:en,deleteProperty:ed,propertyToFormData:ec,clearError:eo}=(0,ea.hG)();(0,t.useEffect)(()=>{(async()=>{try{let{data:{user:s},error:r}=await l.O.auth.getUser();if(r||!s){console.error("No hay usuario v\xe1lido:",r),e.replace("/admin/login");return}let{data:t,error:i}=await l.O.from("admin_users").select("*").eq("email",s.email).single();if(i||!t){console.error("Usuario no es administrador:",i),await l.O.auth.signOut(),e.replace("/admin/login");return}a(s),m(t)}catch(s){console.error("Error al inicializar dashboard:",s),N("Error al cargar el panel de administraci\xf3n"),setTimeout(()=>{e.replace("/admin/login")},2e3)}finally{g(!1)}})();let{data:{subscription:s}}=l.O.auth.onAuthStateChange(async(s,r)=>{if("SIGNED_OUT"===s)a(null),m(null),e.replace("/admin/login");else if("SIGNED_IN"===s&&(null==r?void 0:r.user))try{let{data:{user:e},error:s}=await l.O.auth.getUser();if(s||!e){await l.O.auth.signOut();return}let{data:r,error:t}=await l.O.from("admin_users").select("*").eq("email",e.email).single();if(t||!r){await l.O.auth.signOut();return}a(e),m(r)}catch(e){console.error("Error al verificar permisos:",e),await l.O.auth.signOut()}});return()=>{s.unsubscribe()}},[e]);let em=()=>{k(ea.CH),I(null),eo()},ex=async e=>{e.preventDefault();try{P(!0);(R?await en(R.id,z):await ei(z))&&(S(!1),em())}catch(e){console.error("Error al guardar propiedad:",e)}finally{P(!1)}},eu=e=>{I(e),k(ec(e)),S(!0)},eh=async(e,s)=>{confirm('\xbfEst\xe1s seguro de que quieres eliminar la propiedad "'.concat(s,'"?\n\nEsto eliminar\xe1 tanto la propiedad como sus im\xe1genes del Storage.'))&&!await ed(e)&&et&&alert(et)},eg=async()=>{try{V(!0);let{error:s}=await l.O.auth.signOut();if(s){console.error("Error al cerrar sesi\xf3n:",s),N("Error al cerrar sesi\xf3n"),V(!1);return}e.push("/admin/login"),setTimeout(()=>{window.location.href="/admin/login"},100)}catch(e){console.error("Error al cerrar sesi\xf3n:",e),N("Error al cerrar sesi\xf3n"),V(!1)}};return x?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(E.Z,{className:"h-10 w-10 animate-spin text-primary"}),(0,r.jsx)(M.Z,{className:"absolute inset-0 h-10 w-10 text-primary/20"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 font-medium",children:"Verificando permisos de administrador..."})]})}):p?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsx)(i.Zb,{className:"w-full max-w-md",children:(0,r.jsx)(i.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,r.jsx)(q.Z,{className:"h-12 w-12 text-red-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Error de Acceso"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:p})]}),(0,r.jsx)(n.z,{onClick:()=>e.push("/admin/login"),className:"w-full",children:"Volver al Login"})]})})})}):s&&o?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-3 bg-blue-100 rounded-xl",children:(0,r.jsx)(M.Z,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Panel de Administraci\xf3n"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Sistema de gesti\xf3n de propiedades inmobiliarias"})]})]}),(0,r.jsx)(n.z,{onClick:eg,disabled:Y,variant:"outline",className:"hover:bg-red-50 hover:text-red-600 hover:border-red-200 bg-white",children:Y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(E.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Cerrando..."]}):"Cerrar Sesi\xf3n"})]})}),(0,r.jsxs)(y,{value:A,onValueChange:D,className:"space-y-6",children:[(0,r.jsxs)(v,{className:"grid w-full grid-cols-4 bg-white border border-gray-200",children:[(0,r.jsx)(w,{value:"overview",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:border-blue-200",children:"Resumen"}),(0,r.jsx)(w,{value:"properties",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:border-blue-200",children:"Propiedades"}),(0,r.jsxs)(w,{value:"storage",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:border-blue-200",children:[(0,r.jsx)(L.Z,{className:"w-4 h-4 mr-1"}),"Storage"]}),(0,r.jsx)(w,{value:"profile",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:border-blue-200",children:"Perfil"})]}),(0,r.jsxs)(C,{value:"overview",className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,r.jsx)(i.Zb,{className:"stats-card",children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Propiedades"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:el.total})]}),(0,r.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,r.jsx)(W.Z,{className:"h-6 w-6 text-blue-600"})})]})})}),(0,r.jsx)(i.Zb,{className:"stats-card",children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"En Venta"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:el.ventas})]}),(0,r.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,r.jsx)($.Z,{className:"h-6 w-6 text-green-600"})})]})})}),(0,r.jsx)(i.Zb,{className:"stats-card",children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"En Alquiler"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:el.alquileres})]}),(0,r.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg",children:(0,r.jsx)(J.Z,{className:"h-6 w-6 text-purple-600"})})]})})}),(0,r.jsx)(i.Zb,{className:"stats-card",children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Destacadas"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:el.destacadas})]}),(0,r.jsx)("div",{className:"p-3 bg-orange-100 rounded-lg",children:(0,r.jsx)(T.Z,{className:"h-6 w-6 text-orange-600"})})]})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,r.jsx)(i.Zb,{className:"bg-white border border-green-200",children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 rounded-lg w-fit mx-auto mb-3",children:(0,r.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"})}),(0,r.jsx)("p",{className:"text-sm font-medium text-green-700",children:"Disponibles"}),(0,r.jsx)("p",{className:"text-xl font-bold text-green-800",children:el.disponibles})]})})}),(0,r.jsx)(i.Zb,{className:"bg-white border border-red-200",children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"p-2 bg-red-100 rounded-lg w-fit mx-auto mb-3",children:(0,r.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"})}),(0,r.jsx)("p",{className:"text-sm font-medium text-red-700",children:"Vendidas"}),(0,r.jsx)("p",{className:"text-xl font-bold text-red-800",children:el.vendidas})]})})}),(0,r.jsx)(i.Zb,{className:"bg-white border border-blue-200",children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg w-fit mx-auto mb-3",children:(0,r.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"})}),(0,r.jsx)("p",{className:"text-sm font-medium text-blue-700",children:"Alquiladas"}),(0,r.jsx)("p",{className:"text-xl font-bold text-blue-800",children:el.alquiladas})]})})}),(0,r.jsx)(i.Zb,{className:"bg-white border border-yellow-200",children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"p-2 bg-yellow-100 rounded-lg w-fit mx-auto mb-3",children:(0,r.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"})}),(0,r.jsx)("p",{className:"text-sm font-medium text-yellow-700",children:"Reservadas"}),(0,r.jsx)("p",{className:"text-xl font-bold text-yellow-800",children:el.reservadas})]})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(H,{onViewDetails:()=>D("storage")}),(0,r.jsxs)(i.Zb,{className:"bg-white border border-gray-200 shadow-sm md:col-span-1",children:[(0,r.jsx)(i.Ol,{className:"border-b border-gray-100",children:(0,r.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,r.jsx)(M.Z,{className:"h-5 w-5 text-green-600"})}),"Bienvenido al Sistema"]})}),(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Informaci\xf3n del Administrador"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-800",children:"Email:"})," ",o.email]}),o.name&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-800",children:"Nombre:"})," ",o.name]}),o.role&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium text-gray-800",children:"Rol:"})," ",o.role]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Estado de la Sesi\xf3n"}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,r.jsx)("span",{children:"Autenticado correctamente"})]}),(0,r.jsxs)("p",{children:["\xdaltimo acceso: ",new Date().toLocaleString("es-ES")]})]})]})]})})]})]})]}),(0,r.jsxs)(C,{value:"properties",className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Gesti\xf3n de Propiedades"}),(0,r.jsxs)(u,{open:_,onOpenChange:S,children:[(0,r.jsx)(h,{asChild:!0,children:(0,r.jsxs)(n.z,{onClick:em,className:"flex items-center gap-2 bg-primary-400 hover:bg-primary-500 text-white",children:[(0,r.jsx)(K.Z,{className:"h-4 w-4"}),"Agregar Propiedad"]})}),(0,r.jsxs)(f,{className:"max-w-4xl max-h-[80vh] overflow-y-auto bg-white",children:[(0,r.jsx)(j,{children:(0,r.jsx)(b,{children:R?"Editar Propiedad":"Agregar Nueva Propiedad"})}),et&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:(0,r.jsx)("p",{className:"text-sm text-red-600",children:et})}),(0,r.jsx)(F,{formData:z,onInputChange:(e,s)=>{k(a=>({...a,[e]:s}))},onSubmit:ex,isLoading:O,isEditing:!!R,onCancel:()=>S(!1)})]})]})]}),er?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(E.Z,{className:"h-8 w-8 animate-spin text-blue-600"})}):0===U.length?(0,r.jsx)(i.Zb,{className:"bg-white border border-gray-200",children:(0,r.jsxs)(i.aY,{className:"p-8 text-center",children:[(0,r.jsx)("div",{className:"p-4 bg-gray-100 rounded-full w-fit mx-auto mb-4",children:(0,r.jsx)(W.Z,{className:"h-12 w-12 text-gray-400"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay propiedades"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Agrega tu primera propiedad para comenzar"})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:U.map(e=>(0,r.jsx)(i.Zb,{className:"overflow-hidden bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:(0,r.jsxs)(i.aY,{className:"p-0",children:[(0,r.jsxs)("div",{className:"h-48 bg-gray-100 flex items-center justify-center relative",children:[e.images.length>0?(0,r.jsx)("img",{src:e.images[0],alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.src="",e.currentTarget.style.display="none"}}):(0,r.jsxs)("div",{className:"flex flex-col items-center text-gray-400",children:[(0,r.jsx)(X.Z,{className:"h-12 w-12 mb-2"}),(0,r.jsx)("span",{className:"text-sm",children:"Sin imagen"})]}),e.featured&&(0,r.jsx)(Z.C,{className:"absolute top-2 left-2 bg-orange-500 hover:bg-orange-600 text-white border-0",children:"Destacada"}),(0,r.jsx)(Z.C,{className:"absolute top-2 right-2 border-0 text-white ".concat("disponible"===e.status?"bg-green-500 hover:bg-green-600":"vendido"===e.status?"bg-red-500 hover:bg-red-600":"alquilado"===e.status?"bg-blue-500 hover:bg-blue-600":"bg-yellow-500 hover:bg-yellow-600"),children:e.status})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 line-clamp-2",children:e.title}),(0,r.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,r.jsx)(n.z,{size:"sm",variant:"outline",onClick:()=>eu(e),className:"h-8 w-8 p-0 bg-white hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200",children:(0,r.jsx)(ee.Z,{className:"h-4 w-4"})}),(0,r.jsx)(n.z,{size:"sm",variant:"outline",onClick:()=>eh(e.id,e.title),className:"h-8 w-8 p-0 bg-white hover:bg-red-50 hover:text-red-600 hover:border-red-200",children:(0,r.jsx)(Q.Z,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)($.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{className:"font-semibold text-gray-900",children:[e.currency," ",e.price.toLocaleString()]}),(0,r.jsx)(Z.C,{variant:"outline",className:"ml-2 bg-gray-50 text-gray-700 border-gray-200",children:e.operation_type})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(J.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:e.property_type}),e.bedrooms>0&&(0,r.jsxs)("span",{className:"ml-2",children:[e.bedrooms," dorm."]}),e.bathrooms>0&&(0,r.jsxs)("span",{className:"ml-1",children:[e.bathrooms," ba\xf1os"]})]}),(e.address||e.neighborhood)&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(es.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{className:"line-clamp-1",children:[e.address,e.address&&e.neighborhood&&", ",e.neighborhood]})]}),e.area_m2&&(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["\xc1rea: ",e.area_m2," m\xb2"]})]}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:e.description}),e.features.length>0&&(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1",children:[e.features.slice(0,3).map((e,s)=>(0,r.jsx)(Z.C,{variant:"secondary",className:"text-xs bg-gray-100 text-gray-700 hover:bg-gray-200",children:e},s)),e.features.length>3&&(0,r.jsxs)(Z.C,{variant:"secondary",className:"text-xs bg-gray-100 text-gray-700",children:["+",e.features.length-3," m\xe1s"]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 mt-3 pt-2 border-t border-gray-100",children:["Creada: ",new Date(e.created_at).toLocaleDateString("es-ES")]})]})]})},e.id))})]}),(0,r.jsxs)(C,{value:"storage",className:"space-y-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Gesti\xf3n de Storage de Im\xe1genes"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Administra las im\xe1genes del bucket de Supabase, identifica y limpia archivos hu\xe9rfanos"})]}),(0,r.jsx)(B,{})]}),(0,r.jsx)(C,{value:"profile",className:"space-y-6",children:(0,r.jsxs)(i.Zb,{className:"bg-white border border-gray-200 shadow-sm",children:[(0,r.jsx)(i.Ol,{className:"border-b border-gray-100",children:(0,r.jsx)(i.ll,{children:"Informaci\xf3n del Perfil"})}),(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{className:"text-gray-700 font-medium",children:"Email"}),(0,r.jsx)(d.I,{value:o.email,disabled:!0,className:"mt-1 bg-gray-50 border-gray-200"})]}),o.name&&(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{className:"text-gray-700 font-medium",children:"Nombre"}),(0,r.jsx)(d.I,{value:o.name,disabled:!0,className:"mt-1 bg-gray-50 border-gray-200"})]}),o.role&&(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{className:"text-gray-700 font-medium",children:"Rol"}),(0,r.jsx)(d.I,{value:o.role,disabled:!0,className:"mt-1 bg-gray-50 border-gray-200"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c._,{className:"text-gray-700 font-medium",children:"Fecha de Registro"}),(0,r.jsx)(d.I,{value:new Date(o.created_at).toLocaleString("es-ES"),disabled:!0,className:"mt-1 bg-gray-50 border-gray-200"})]})]})})]})})]})]})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsx)(i.Zb,{className:"w-full max-w-md",children:(0,r.jsx)(i.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(q.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Acceso Denegado"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"No tienes permisos para acceder a esta p\xe1gina"}),(0,r.jsx)(n.z,{className:"mt-4 w-full",onClick:()=>e.push("/admin/login"),children:"Ir al Login"})]})})})})}},2381:function(e,s,a){"use strict";a.d(s,{z:function(){return c}});var r=a(7437),t=a(2265),l=a(7053),i=a(535),n=a(3448);let d=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary-400 text-white hover:bg-primary-500",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-primary-400 text-primary-400 bg-white hover:bg-primary-50 hover:text-primary-500",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",ghost:"hover:bg-primary-50 hover:text-primary-500",link:"text-primary-400 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=t.forwardRef((e,s)=>{let{className:a,variant:t,size:i,asChild:c=!1,...o}=e,m=c?l.g7:"button";return(0,r.jsx)(m,{className:(0,n.cn)(d({variant:t,size:i,className:a})),ref:s,...o})});c.displayName="Button"},9820:function(e,s,a){"use strict";a.d(s,{Ol:function(){return n},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},ll:function(){return d}});var r=a(7437),t=a(2265),l=a(3448);let i=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border border-gray-200 bg-white text-gray-900 shadow-sm",a),...t})});i.displayName="Card";let n=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...t})});n.displayName="CardHeader";let d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("h3",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight text-gray-900",a),...t})});d.displayName="CardTitle";let c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("p",{ref:s,className:(0,l.cn)("text-sm text-gray-600",a),...t})});c.displayName="CardDescription";let o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",a),...t})});o.displayName="CardContent",t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",a),...t})}).displayName="CardFooter"},279:function(e,s,a){"use strict";a.d(s,{I:function(){return i}});var r=a(7437),t=a(2265),l=a(3448);let i=t.forwardRef((e,s)=>{let{className:a,type:t,...i}=e;return(0,r.jsx)("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white text-gray-900 px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-gray-900 placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...i})});i.displayName="Input"},5060:function(e,s,a){"use strict";a.d(s,{_:function(){return c}});var r=a(7437),t=a(2265),l=a(6394),i=a(535),n=a(3448);let d=(0,i.j)("text-sm font-medium leading-none text-gray-700 peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.f,{ref:s,className:(0,n.cn)(d(),a),...t})});c.displayName=l.f.displayName},5291:function(e,s,a){"use strict";a.d(s,{Bw:function(){return g},Ph:function(){return o},Ql:function(){return p},i4:function(){return x},ki:function(){return m}});var r=a(7437),t=a(2265),l=a(7265),i=a(875),n=a(2135),d=a(401),c=a(3448);let o=l.fC;l.ZA;let m=l.B4,x=t.forwardRef((e,s)=>{let{className:a,children:t,...n}=e;return(0,r.jsxs)(l.xz,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border bg-white text-gray-900 border-gray-200 px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[t,(0,r.jsx)(l.JO,{asChild:!0,children:(0,r.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=l.xz.displayName;let u=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.u_,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...t,children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})});u.displayName=l.u_.displayName;let h=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.$G,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...t,children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})});h.displayName=l.$G.displayName;let g=t.forwardRef((e,s)=>{let{className:a,children:t,position:i="popper",...n}=e;return(0,r.jsx)(l.h_,{children:(0,r.jsxs)(l.VY,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-white text-gray-900 border-gray-200 shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...n,children:[(0,r.jsx)(u,{}),(0,r.jsx)(l.l_,{className:(0,c.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,r.jsx)(h,{})]})})});g.displayName=l.VY.displayName,t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.__,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...t})}).displayName=l.__.displayName;let p=t.forwardRef((e,s)=>{let{className:a,children:t,...i}=e;return(0,r.jsxs)(l.ck,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm text-gray-900 outline-none hover:bg-gray-100 focus:bg-gray-100 data-[highlighted]:bg-gray-100",a),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.wU,{children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(l.eT,{children:t})]})});p.displayName=l.ck.displayName,t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(l.Z0,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...t})}).displayName=l.Z0.displayName},3675:function(e,s,a){"use strict";a.d(s,{g:function(){return i}});var r=a(7437),t=a(2265),l=a(3448);let i=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-gray-300 bg-white text-gray-900 px-3 py-2 text-sm ring-offset-background placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...t})});i.displayName="Textarea"},3448:function(e,s,a){"use strict";a.d(s,{T4:function(){return i},cn:function(){return l}});var r=a(1994),t=a(3335);function l(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,t.m6)((0,r.W)(s))}function i(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD",a=new Intl.NumberFormat("es-AR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return"".concat(s," ").concat(a)}}},function(e){e.O(0,[284,501,554,194,676,259,971,117,744],function(){return e(e.s=3060)}),_N_E=e.O()}]);